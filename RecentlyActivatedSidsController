package com.jpmc.cwoc.controllers.cwoc.reports;

import com.jpmc.cwoc.cwoc.recentlyActivatedSids.RecentlyActivatedSidsRequestVO;
import com.jpmc.cwoc.neim.WorkerExcelExportService;
import io.swagger.annotations.ApiOperation;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.io.InputStreamResource;
import org.springframework.web.bind.annotation.*;

import javax.servlet.http.HttpServletResponse;
import java.io.ByteArrayInputStream;
import java.io.IOException;

@RestController
@RequestMapping("/cwoc/recentlyActivatedSid")
@CrossOrigin
public class RecentlyActivatedSidsController {
    @Autowired
    private WorkerExcelExportService workerExcelExportService;


    @ApiOperation(value = "Export reactivatedSids to excel ")
    @PostMapping(value = "/exportRecentlyActivatedSids")
    public InputStreamResource exportReactivatedSids(@RequestBody RecentlyActivatedSidsRequestVO reactivatedSIDVO, HttpServletResponse response ) throws IOException {
        response.setHeader("Content-Disposition", "attachment; filename=report.xlsx");
        response.setHeader("Content-Type", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");

        ByteArrayInputStream byteArrayInputStream = workerExcelExportService.exportReactivatedSids(reactivatedSIDVO.getStartDate(),reactivatedSIDVO.getEndDate());

        return new InputStreamResource(byteArrayInputStream);
    }
}
